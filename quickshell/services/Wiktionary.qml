//
//
//
// <div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
//     <meta property="mw:PageProp/toc" />\n
//     <div class="mw-heading mw-heading4">
//         <h4 id="Noun">Noun</h4><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=test&amp;action=edit&amp;section=1" title="Edit section: Noun"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span>
//     </div>\n
//     <p><span class="headword-line"><strong class="Latn headword" lang="en">test</strong> (<i>plural</i> <b class="Latn form-of lang-en p-form-of" lang="en"><a href="/wiki/tests#English" title="tests">tests</a></b>)</span>\n</p>\n
//     <ol>
//         <li>A <a href="/wiki/challenge#Noun" title="challenge">challenge</a>, <a href="/wiki/trial" title="trial">trial</a>.\n
//             <ul>
//                 <li>
//                     <div class="citation-whole"><span class="cited-source"><span class="None" lang="und"><b>2012</b></span> March-April, Colin Allen, “Do I See What You See?”, in <cite><a href="https://en.wikipedia.org/wiki/American_Scientist" class="extiw" title="w:American Scientist">American Scientist</a></cite>&#8206;<sup><a rel="nofollow" class="external autonumber" href="https://web.archive.org/web/20120426001327/http://www.americanscientist.org/bookshelf/pub/do-i-see-what-you-see">[1]</a></sup>, volume <span class="None" lang="und">100</span>, number 2, archived from <a rel="nofollow" class="external text" href="http://www.americanscientist.org/bookshelf/pub/do-i-see-what-you-see">the original</a> on <span class="mw-formatted-date" title="2012-04-26">26 April 2012</span>, page <span class="None" lang="und">168</span>:</span>
//                         <dl>
//                             <dd>
//                                 <div class="h-quotation"><span class="Latn e-quotation cited-passage" lang="en">Numerous experimental <b>tests</b> and other observations have been offered in favor of animal mind reading, and although many scientists are skeptical, others assert that humans are not the only species capable of representing what others do and don’t perceive and know.</span></div>
//                             </dd>
//                         </dl>
//                     </div>
//                 </li>
//             </ul>
//         </li>\n
//         <li>A <a href="/wiki/cupel" title="cupel">cupel</a> or cupelling <a href="/wiki/hearth" title="hearth">hearth</a> in which <a href="/wiki/precious_metal" title="precious metal">precious metals</a> are <a href="/wiki/melt" title="melt">melted</a> for trial and refinement.</li>\n
//         <li><span class="usage-label-sense"><span class="ib-brac label-brac">(</span><span class="ib-content label-content">academia</span><span class="ib-brac label-brac">)</span></span> An <a href="/wiki/examination" title="examination">examination</a>, given often during the academic <a href="/wiki/term" title="term">term</a>.</li>\n
//         <li>A <a href="/wiki/session" title="session">session</a> in which a <a href="/wiki/product" title="product">product</a>, piece of <a href="/wiki/equipment" title="equipment">equipment</a>, or <a href="/wiki/system" title="system">system</a> is <a href="/wiki/examine" title="examine">examined</a> under <a href="/wiki/everyday" title="everyday">everyday</a> or <a href="/wiki/extreme" title="extreme">extreme</a> <a href="/wiki/condition" title="condition">conditions</a> to <a href="/wiki/evaluate" title="evaluate">evaluate</a> its <a href="/wiki/durability" title="durability">durability</a>, etc.\n
//             <ul>
//                 <li>
//                     <div class="citation-whole"><span class="cited-source"><span class="None" lang="und"><b>1986</b></span>, <a href="https://en.wikipedia.org/wiki/%22Weird_Al%22_Yankovic" class="extiw" title="w:&quot;Weird Al&quot; Yankovic">"Weird Al" Yankovic</a>, “<a href="https://en.wikipedia.org/wiki/Christmas_at_Ground_Zero" class="extiw" title="w:Christmas at Ground Zero">Christmas at Ground Zero</a>”, in <cite><a href="https://en.wikipedia.org/wiki/Polka_Party!" class="extiw" title="w:Polka Party!">Polka Party&#33;</a></cite>&#8206;<sup><a rel="nofollow" class="external autonumber" href="https://www.youtube.com/watch?v=t039p6xqutU">[2]</a></sup>:</span>
//                         <dl>
//                             <dd>
//                                 <div class="h-quotation"><span class="Latn e-quotation cited-passage" lang="en">It's Christmas at ground zero &#47; The button has been pressed &#47; The radio &#47; Just let us know &#47; That this is not a <b>test</b></span></div>
//                             </dd>
//                         </dl>
//                     </div>
//                 </li>
//             </ul>
//         </li>\n
//         <li><span class="usage-label-sense"><span class="ib-brac label-brac">(</span><span class="ib-content label-content"><a href="/wiki/cricket" title="cricket">cricket</a><span class="ib-comma label-comma">,</span>&#32;normally "<a href="/wiki/Test" title="Test">Test</a>"</span><span class="ib-brac label-brac">)</span></span> A <a href="/wiki/Test_match" title="Test match">Test match</a>.</li>\n
//         <li><span class="usage-label-sense"><span class="ib-brac label-brac">(</span><span class="ib-content label-content"><a href="/wiki/marine_biology" title="marine biology">marine biology</a></span><span class="ib-brac label-brac">)</span></span> The external <a href="/wiki/calciferous" title="calciferous">calciferous</a> shell, or <a href="/wiki/endoskeleton" title="endoskeleton">endoskeleton</a>, of an <a href="/wiki/echinoderm" title="echinoderm">echinoderm</a>, e.g. <a href="/wiki/sand_dollar" title="sand dollar">sand dollars</a> and <a href="/wiki/sea_urchin" title="sea urchin">sea urchins</a>; <a href="/wiki/testa" title="testa">testa</a>.
//             <figure class="mw-default-size mw-halign-right" typeof="mw:File/Thumb">
//                 <a href="/wiki/File:Sea_urchin_tests.jpg" class="mw-file-description"><img src="//upload.wikimedia.org/wikipedia/commons/thumb/7/77/Sea_urchin_tests.jpg/250px-Sea_urchin_tests.jpg" decoding="async" width="250" height="239" class="mw-file-element" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/7/77/Sea_urchin_tests.jpg/500px-Sea_urchin_tests.jpg 1.5x" data-file-width="2178" data-file-height="2086" /></a>
//                 <figcaption>Two sea urchin tests</figcaption>
//             </figure>
//         </li>\n
//         <li><span class="usage-label-sense"><span class="ib-brac label-brac">(</span><span class="ib-content label-content"><a href="/wiki/botany" title="botany">botany</a></span><span class="ib-brac label-brac">)</span></span> <a href="/wiki/testa" title="testa">Testa</a>; <a href="/wiki/seed_coat" title="seed coat">seed coat</a>.</li>\n
//         <li><span class="usage-label-sense"><span class="ib-brac label-brac">(</span><span class="ib-content label-content"><a href="/wiki/Appendix:Glossary#obsolete" title="Appendix:Glossary">obsolete</a></span><span class="ib-brac label-brac">)</span></span> <a href="/wiki/judgment" title="judgment">Judgment</a>; <a href="/wiki/distinction" title="distinction">distinction</a>; <a href="/wiki/discrimination" title="discrimination">discrimination</a>.\n
//             <ul>
//                 <li>
//                     <div class="citation-whole"><span class="cited-source"><span class="None" lang="und"><b>1675</b></span>, <a href="https://en.wikipedia.org/wiki/John_Dryden" class="extiw" title="w:John Dryden">John Dryden</a>, <cite><a href="https://en.wikipedia.org/wiki/Aureng-zebe" class="extiw" title="w:Aureng-zebe">Aureng-zebe: A Tragedy.<span class="q-hellip-sp">&#160;</span><span class="q-hellip-b"><span style="font-style: normal;">[</span></span><span title="Acted at the Royal Theatre.">…</span><span class="q-hellip-b"><span style="font-style: normal;">]</span></span><span class="q-hellip-b"></span></a></cite>, London&#58; <span class="q-hellip-sp">&#32;</span><span class="q-hellip-b"><span style="font-style: normal;">[</span></span><span title="Printed by">…</span><span class="q-hellip-b"><span style="font-style: normal;">]</span></span><span class="q-hellip-b">&#32;</span> T<span style="font-style: normal;">[</span>homas<span style="font-style: normal;">]</span> N<span style="font-style: normal;">[</span>ewcomb<span style="font-style: normal;">]</span> for <a href="https://en.wikipedia.org/wiki/Henry_Herringman" class="extiw" title="w:Henry Herringman">Henry Herringman</a>,<span class="q-hellip-sp">&#160;</span><span class="q-hellip-b"><span style="font-style: normal;">[</span></span><span title="at the Anchor at the Lower Walk of the New Exchange.">…</span><span class="q-hellip-b"><span style="font-style: normal;">]</span></span><span class="q-hellip-b"></span>, published <span class="None" lang="und">1676</span>, <small><a rel="nofollow" class="external text" href="https://search.worldcat.org/title/228724395">→OCLC</a></small>, <span class="maintenance-line">(please specify the page number)</span>:</span>
//                         <dl>
//                             <dd>
//                                 <div class="h-quotation"><span class="Latn e-quotation cited-passage" lang="en">Who would excel, when few can make a <b>test</b> &#47; Betwixt indifferent writing and the best&#63;</span></div>
//                             </dd>
//                         </dl>
//                     </div>
//                 </li>
//             </ul>
//         </li>
//     </ol>\n
//     <div class="mw-heading mw-heading5">
//
pragma Singleton

import Quickshell
import QtQuick

Singleton {
    id: root

    function page(title: string): string {
        // https://en.wiktionary.org/w/api.php?action=parse&page=test&format=json&prop=text&section=1
        // Assuming section 1 is English
        Requests.get(`https://en.wiktionary.org/w/api.php?action=parse&page=${title}&format=json&prop=sections&section=1`).then(text => {
            const json = JSON.parse(text);
            const word_promises = function*() {
                for (const section of json.parse.sections) {
                    if (["Noun", "Verb", "Adjective", "Adverb"].includes(section.line)) {
                        yield Requests.get(
                            `https://en.wiktionary.org/w/api.php?action=parse&page=${title}&format=json&prop=text&section=${section.index}`
                        );
                    }
                }
            }(json);
            // pages.forEach(); QT bug?
            for (const promise of word_promises){
                promise.then(text => {
                    const json = JSON.parse(text);
                    console.log("a")
                    const page = json.parse.text["*"].split("<h5>")[0].split("<ol>")[1].split("</ol>")[0].replace(
                        /<([aib]|span)[^>]*>|<\/([aib]|span)>g/,
                        "");
                    // TODO 
                    console.log(page);
                });
            }
        });
        return "a";
    }

    function search() {
        // https://en.wiktionary.org/w/api.php?action=opensearch&search=Te
        return [];
    }
}
